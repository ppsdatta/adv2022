(ns adv.y2022)

(defn convert-input-line [line]
  (let [pairs (.split line "\\,")]
    (map #(map (fn [x] (Integer/parseInt x)) %)
         (map #(.split % "\\-") pairs))))

(defn make-ranges
  [pairs]
  (map (fn [[x y]] (range x (inc y))) pairs))

(defn full-intersect?
  [[r1 r2]]
  (let [i (clojure.set/intersection (set r1) (set r2))]
    (or (= (count i) (count r1))
        (= (count i) (count r2)))))

(defn partial-intersect?
  [[r1 r2]]
  (let [i (clojure.set/intersection (set r1) (set r2))]
    (> (count i) 0)))

(defn part-fn
  [s fn]
  (->>
    (map #(->> %
               (convert-input-line)
               (make-ranges)
               (fn))
         (.split s "\\n"))
    (filter true?)
    (count)))

(defn part1
  [s]
  (part-fn s full-intersect?))

(defn part2
  [s]
  (part-fn s partial-intersect?))

(part1 "2-4,6-8\n2-3,4-5\n5-7,7-9\n2-8,3-7\n6-6,4-6\n2-6,4-8")
(part2 "2-4,6-8\n2-3,4-5\n5-7,7-9\n2-8,3-7\n6-6,4-6\n2-6,4-8")

(def input "17-99,18-24\n14-91,22-91\n63-76,66-83\n17-57,17-28\n77-88,14-78\n15-92,14-15\n23-23,24-40\n14-42,41-42\n23-74,21-24\n6-94,94-94\n16-18,17-52\n50-96,40-96\n4-67,3-66\n26-81,26-99\n18-93,24-93\n13-18,17-61\n7-46,47-92\n46-91,46-98\n1-73,72-73\n51-86,36-52\n16-16,13-16\n5-35,1-36\n14-99,5-15\n2-32,2-92\n45-86,44-45\n10-96,10-97\n2-89,89-95\n9-95,8-97\n40-78,41-50\n48-66,4-49\n21-24,22-49\n43-92,98-98\n91-92,42-92\n3-95,3-98\n8-11,10-99\n65-75,40-64\n55-83,82-82\n34-50,24-35\n20-62,19-62\n43-74,42-46\n28-32,28-32\n38-52,51-51\n5-75,66-75\n32-46,41-55\n97-97,2-98\n13-34,12-13\n33-93,85-99\n7-80,12-79\n98-98,54-99\n37-38,38-79\n20-79,28-82\n1-1,2-66\n7-68,1-30\n35-35,36-52\n3-46,2-46\n21-62,51-63\n30-30,29-42\n7-64,8-64\n4-94,5-93\n35-60,36-60\n75-76,69-76\n6-80,5-95\n23-50,24-50\n25-92,89-92\n34-56,35-35\n65-84,65-69\n47-76,47-96\n1-3,2-98\n10-55,16-55\n5-89,99-99\n8-74,7-74\n13-82,13-82\n1-99,3-98\n11-17,10-29\n81-98,63-98\n61-71,60-97\n6-92,60-91\n7-96,6-96\n18-81,13-82\n46-61,47-91\n22-91,19-91\n23-23,23-95\n20-20,21-96\n4-69,8-70\n5-22,21-59\n74-80,75-81\n95-95,24-93\n15-85,9-86\n6-7,7-93\n11-28,10-12\n15-27,16-62\n12-24,11-33\n21-22,22-65\n31-73,7-30\n2-80,1-81\n1-92,1-90\n4-38,5-19\n1-40,4-94\n49-70,48-48\n3-91,91-91\n32-99,29-33\n11-52,10-70\n16-95,15-17\n18-18,18-26\n83-99,83-84\n11-94,11-12\n27-80,68-80\n17-96,95-96\n2-83,1-91\n58-66,59-65\n45-45,14-54\n2-3,3-92\n47-47,48-85\n39-39,39-77\n30-31,30-63\n10-11,11-43\n6-86,10-85\n45-57,57-58\n1-5,4-97\n1-27,2-53\n7-90,7-90\n3-28,2-3\n77-79,8-78\n45-48,28-47\n13-73,64-74\n14-97,14-83\n50-51,51-94\n21-86,22-22\n11-49,12-49\n30-68,67-68\n48-50,49-81\n24-96,23-24\n27-44,26-28\n9-80,10-74\n44-74,2-44\n66-73,64-78\n8-82,8-82\n3-85,55-93\n22-65,13-64\n10-19,10-26\n79-83,29-79\n48-56,52-60\n25-93,3-93\n1-99,5-97\n60-81,60-81\n15-26,10-24\n50-78,10-51\n32-75,33-75\n11-21,10-93\n1-71,1-98\n29-65,30-35\n52-90,51-52\n56-95,75-94\n8-9,9-98\n2-53,4-52\n7-65,3-13\n73-83,72-83\n9-18,8-76\n14-38,4-37\n22-57,22-78\n2-99,12-98\n2-43,20-44\n13-88,87-95\n5-61,5-63\n14-68,14-52\n9-89,8-99\n43-99,42-43\n10-39,39-39\n45-60,42-45\n39-40,39-89\n44-97,96-96\n10-96,15-99\n50-90,90-94\n40-90,39-89\n39-39,40-66\n15-96,15-96\n48-59,49-58\n19-58,18-19\n21-92,20-91\n1-89,1-2\n13-91,12-14\n70-80,69-94\n28-92,27-28\n5-95,95-95\n21-22,22-74\n2-58,3-7\n35-51,35-36\n88-89,1-89\n84-86,73-85\n22-63,9-58\n44-93,44-45\n54-81,53-54\n5-91,90-92\n12-29,2-25\n4-97,97-97\n1-90,8-89\n17-37,17-37\n10-89,15-90\n18-19,19-19\n24-44,25-75\n21-77,17-77\n1-99,2-97\n12-91,11-91\n50-64,50-64\n51-97,52-97\n7-45,6-6\n61-62,61-82\n5-8,5-13\n13-35,36-94\n91-91,44-93\n2-78,1-1\n51-52,52-80\n52-74,52-80\n58-63,15-62\n9-78,9-9\n19-93,20-93\n7-18,4-17\n27-73,72-98\n17-89,16-88\n20-83,21-61\n55-55,55-96\n43-88,48-87\n52-62,51-93\n5-27,10-26\n3-62,2-93\n3-95,4-87\n30-96,62-97\n25-26,46-97\n44-82,43-88\n9-30,11-97\n31-32,31-77\n25-26,25-77\n18-55,17-19\n14-91,15-92\n7-76,8-76\n62-63,63-66\n26-99,7-47\n5-79,4-4\n2-97,3-97\n85-86,35-85\n6-90,21-90\n44-90,90-90\n32-89,33-84\n28-88,31-87\n27-45,28-43\n26-52,47-63\n14-53,24-82\n26-76,26-70\n7-90,9-91\n69-69,11-69\n10-82,10-47\n39-68,40-40\n10-94,10-10\n28-78,27-82\n7-95,96-96\n68-83,68-83\n28-51,50-50\n98-99,2-99\n7-65,6-6\n52-54,53-80\n13-78,13-70\n96-96,28-96\n59-60,20-60\n44-78,36-44\n13-15,14-68\n38-71,71-72\n6-92,6-98\n42-77,43-58\n31-61,25-60\n3-97,12-98\n3-36,2-3\n29-69,32-96\n17-69,17-89\n4-96,4-96\n79-99,72-97\n1-99,98-99\n22-95,21-22\n2-97,2-3\n5-96,4-97\n23-24,24-53\n6-96,96-98\n75-76,4-76\n4-67,7-66\n53-91,52-98\n37-37,38-99\n36-94,37-95\n21-79,20-22\n42-82,41-42\n28-54,41-59\n57-97,57-57\n47-93,48-93\n28-96,29-92\n15-73,72-73\n89-90,90-99\n47-49,34-48\n80-82,81-84\n60-80,59-80\n11-12,12-77\n36-96,11-37\n16-95,4-95\n2-98,1-1\n51-86,24-52\n89-94,2-90\n8-9,8-90\n2-98,2-3\n4-4,4-5\n5-98,4-5\n67-81,41-81\n1-84,84-84\n7-95,12-95\n5-5,5-86\n1-84,30-99\n58-88,44-71\n50-98,50-98\n18-61,31-74\n47-48,47-69\n2-41,1-41\n65-98,65-98\n28-62,59-62\n3-38,1-4\n34-43,41-44\n26-91,25-25\n17-57,21-57\n20-21,21-86\n20-82,42-81\n1-61,4-70\n49-91,26-73\n5-78,78-78\n27-98,28-98\n55-59,54-61\n3-94,1-3\n6-40,39-99\n16-75,17-54\n1-96,2-97\n7-7,8-96\n11-98,11-98\n96-98,95-97\n5-85,2-85\n1-98,1-1\n6-11,7-35\n5-54,3-68\n19-96,20-96\n49-85,56-85\n33-58,57-57\n66-79,67-80\n9-99,8-10\n10-86,46-86\n5-14,13-86\n42-96,19-69\n2-83,11-83\n9-29,9-93\n9-80,8-38\n28-28,29-82\n5-73,5-48\n23-54,23-54\n17-96,6-74\n49-76,48-77\n36-59,37-48\n12-96,11-97\n81-98,82-99\n41-41,42-50\n9-9,10-15\n87-91,11-91\n54-63,55-64\n45-46,45-70\n72-82,68-91\n6-94,93-94\n18-64,19-64\n46-64,34-48\n7-62,61-63\n2-95,3-95\n45-45,46-55\n57-65,56-94\n33-95,94-98\n22-88,22-28\n68-89,69-90\n10-24,11-15\n32-98,26-55\n5-83,83-83\n13-79,11-14\n44-46,45-81\n2-94,1-1\n54-64,52-64\n12-21,21-96\n38-39,7-39\n73-96,60-76\n69-94,2-70\n1-5,3-3\n36-79,28-46\n1-8,2-56\n30-31,5-30\n8-89,15-90\n7-93,30-96\n85-87,63-86\n10-10,11-77\n2-5,2-97\n16-96,17-79\n52-68,52-55\n15-91,14-38\n1-62,2-62\n63-98,62-64\n8-76,30-76\n1-3,2-93\n22-92,7-91\n11-44,12-57\n3-4,3-46\n9-9,10-86\n43-58,43-50\n13-67,64-68\n2-3,3-77\n12-97,35-99\n1-99,4-99\n29-56,15-56\n52-98,53-84\n24-80,9-59\n10-10,1-11\n12-49,19-79\n10-15,11-84\n17-71,14-18\n42-89,41-45\n3-97,97-98\n42-42,43-83\n9-74,32-74\n20-21,21-89\n55-55,54-54\n67-78,41-68\n21-22,22-93\n11-66,11-87\n11-11,11-93\n94-94,18-95\n1-99,13-99\n57-89,6-57\n18-19,18-25\n6-15,6-39\n17-96,3-95\n10-77,9-11\n34-94,33-34\n26-60,45-60\n25-25,12-98\n77-78,63-78\n29-29,29-70\n94-99,36-95\n91-91,2-92\n3-25,4-6\n78-88,79-85\n60-80,59-80\n64-93,60-89\n63-78,47-75\n36-85,84-98\n90-90,47-90\n2-39,5-39\n6-90,24-91\n12-96,21-97\n57-98,56-58\n27-76,76-76\n24-80,24-25\n50-90,89-98\n90-99,90-97\n17-44,44-45\n4-77,1-77\n46-90,47-86\n10-86,10-86\n24-80,23-80\n24-24,24-96\n20-22,20-24\n2-77,5-77\n47-61,46-46\n65-67,66-75\n8-18,7-18\n18-19,18-95\n50-85,50-85\n63-82,62-82\n2-62,47-77\n22-38,23-92\n64-90,64-74\n62-77,63-65\n14-15,15-84\n30-51,31-75\n25-38,30-39\n1-84,2-75\n38-81,39-80\n30-83,5-83\n11-91,21-90\n30-90,31-90\n25-93,92-98\n87-93,69-88\n14-51,12-60\n32-32,31-31\n33-89,50-90\n2-96,1-96\n96-99,12-97\n43-44,3-42\n2-94,3-94\n7-10,9-90\n59-65,38-65\n6-17,5-13\n37-83,38-47\n57-72,9-72\n3-4,4-42\n1-93,2-83\n34-63,11-62\n1-92,7-92\n39-39,39-63\n13-98,14-91\n96-96,2-96\n3-94,2-2\n97-97,17-98\n3-94,3-99\n18-95,17-19\n44-54,41-52\n24-29,25-69\n4-8,7-59\n16-93,8-93\n23-53,53-54\n74-98,73-73\n96-99,50-96\n33-99,33-86\n19-34,9-35\n12-30,15-47\n3-85,34-86\n11-23,13-35\n28-45,21-46\n2-99,2-50\n7-83,81-81\n39-65,40-95\n3-69,5-68\n1-94,3-93\n2-89,1-2\n1-58,3-82\n3-88,1-56\n4-21,20-39\n59-64,44-64\n49-81,81-81\n11-97,11-12\n84-84,19-85\n45-46,35-46\n4-20,3-54\n45-95,44-95\n40-40,14-41\n7-61,8-61\n41-86,85-86\n46-46,42-47\n75-75,76-76\n6-99,7-94\n57-94,58-95\n3-83,1-84\n35-35,36-58\n22-63,21-64\n85-85,86-94\n3-50,2-20\n12-78,78-91\n2-95,6-96\n18-62,26-61\n13-90,13-92\n1-17,17-67\n16-18,17-57\n32-85,32-97\n87-89,85-89\n41-62,40-63\n3-68,67-87\n26-93,21-92\n24-78,14-78\n3-51,4-51\n5-27,14-26\n26-74,25-88\n47-89,48-88\n27-97,88-96\n6-6,6-60\n24-37,23-60\n41-84,83-85\n78-80,22-79\n92-93,37-92\n18-79,17-79\n22-72,71-91\n28-39,33-35\n45-90,7-90\n4-98,90-99\n27-99,26-35\n1-99,2-2\n62-66,63-97\n65-94,93-93\n68-79,68-93\n70-70,50-71\n74-90,73-95\n7-96,73-97\n1-34,33-34\n16-93,15-15\n55-59,56-62\n2-24,4-24\n43-44,44-74\n18-97,96-97\n4-45,3-3\n13-99,98-98\n7-32,31-38\n41-44,42-49\n28-96,27-59\n5-53,5-37\n68-86,67-96\n34-63,26-64\n97-98,3-97\n30-74,31-85\n9-93,10-98\n66-93,65-76\n30-78,13-78\n29-48,33-48\n8-8,8-99\n10-78,16-78\n30-51,30-30\n19-48,19-19\n10-53,9-54\n3-91,4-91\n42-47,45-56\n47-87,46-65\n8-17,16-78\n34-75,50-74\n98-99,27-98\n16-40,29-41\n22-25,24-84\n9-83,15-84\n75-76,32-75\n11-11,12-99\n14-98,14-15\n66-66,27-66\n8-21,7-20\n4-88,34-89\n38-88,37-77\n80-81,42-81\n4-31,8-95\n8-10,9-89\n55-95,55-73\n29-87,87-88\n2-2,2-99\n28-92,96-98\n9-17,9-42\n48-95,49-94\n4-27,3-91\n43-68,42-72\n76-94,75-87\n8-9,9-96\n15-15,16-79\n15-68,14-36\n11-64,3-62\n8-78,44-77\n49-60,50-64\n15-87,16-79\n86-87,62-87\n24-60,59-60\n1-99,1-99\n26-82,26-82\n2-95,1-97\n6-92,6-93\n16-59,15-58\n7-87,87-87\n87-97,22-88\n45-46,46-46\n10-90,61-90\n16-68,4-68\n17-18,7-18\n36-90,89-89\n38-52,38-78\n13-92,13-92\n34-34,34-38\n50-51,49-82\n7-98,5-20\n5-72,61-82\n48-49,48-97\n23-54,24-80\n19-95,20-67\n13-64,64-64\n49-92,91-92\n74-84,73-83\n18-35,34-59\n61-91,10-91\n70-89,89-89\n1-47,1-2\n21-68,19-22\n38-76,38-96\n29-79,78-79\n29-88,30-73\n35-88,34-58\n21-21,22-68\n35-63,2-64\n13-56,11-11\n12-96,11-96\n6-14,9-59\n3-61,47-84\n14-33,14-15\n62-69,62-92\n33-59,32-59\n3-90,24-89\n37-98,42-99\n5-66,7-67\n28-46,12-29\n31-73,72-73\n15-75,15-96\n12-17,14-16\n92-93,8-93\n7-79,5-45\n21-32,22-29\n23-26,22-95\n2-80,4-80\n11-95,77-95\n69-98,60-96\n67-84,67-73\n81-91,91-92\n38-86,37-85\n11-11,9-30\n1-28,2-52\n20-72,20-72\n4-57,3-98\n37-40,36-40\n24-81,23-23\n20-90,3-89\n43-45,1-44\n2-77,6-77\n11-99,98-98\n63-90,62-85\n3-95,2-98\n18-21,22-43\n20-77,21-77\n53-81,45-84\n79-87,82-87\n1-87,62-90\n34-73,35-84\n56-86,17-86\n13-88,14-84\n17-83,17-82\n24-98,24-59\n8-99,9-27\n72-88,88-88\n9-93,9-82\n59-69,63-91\n20-26,20-25\n1-89,90-92\n59-97,42-81\n41-79,40-42\n28-76,28-77\n33-84,31-83\n42-74,42-75\n22-98,23-96\n17-30,16-62\n28-33,29-83\n3-97,98-98\n7-38,5-38\n61-69,35-68\n77-77,4-78\n40-44,36-46\n35-86,34-35\n57-93,56-72\n37-86,5-86\n24-76,23-76\n1-13,13-14\n69-97,6-97\n6-7,7-37\n1-24,2-6\n36-99,7-97\n10-25,24-97\n32-90,90-91\n2-99,2-94\n14-92,6-91\n24-45,23-57\n32-55,42-47\n46-85,46-47\n4-76,3-19\n80-80,80-95\n69-70,68-70\n7-96,1-81\n68-99,49-96\n22-98,23-27\n64-96,65-97\n24-51,23-50\n32-33,33-84\n20-98,19-98\n17-19,18-92\n2-98,2-98\n26-73,22-85\n36-89,23-87\n65-86,86-97\n17-76,16-91\n25-48,25-37\n42-92,38-92\n3-90,3-56\n91-98,85-92\n38-54,39-54\n7-97,7-99\n31-95,31-32\n27-94,26-28\n57-85,23-84\n52-54,53-87\n45-62,61-62\n16-17,16-75\n14-97,15-98\n1-83,82-82\n1-93,26-93\n12-97,10-96\n87-87,1-88\n29-92,30-93\n21-23,22-90\n7-78,11-79\n7-97,12-95\n8-96,7-98\n11-79,24-80\n20-35,7-31\n39-46,39-39\n38-89,39-89\n33-60,7-63\n3-59,2-2\n21-34,21-88\n1-78,2-77\n61-71,53-71\n21-53,22-53\n47-97,46-97\n47-48,47-69\n79-82,72-81\n94-96,1-95\n28-29,28-62\n51-98,51-59\n9-58,58-84\n11-74,32-74\n80-80,13-79\n12-98,12-94\n47-96,48-97\n50-97,96-99\n65-66,44-88\n38-71,70-99\n22-65,22-23\n12-56,49-55\n10-10,10-58\n30-43,39-62\n61-94,3-62\n60-87,12-60\n12-96,12-98\n1-29,13-32\n7-8,7-73\n27-74,27-74\n66-74,65-75\n53-73,72-73\n2-3,3-98\n9-18,39-46\n1-59,3-98\n9-39,8-97\n54-54,39-55\n23-73,41-91\n48-89,48-91\n17-40,7-41\n77-89,51-78\n22-80,21-80\n9-57,19-69\n28-61,29-60\n98-98,17-99\n11-83,11-83\n32-60,39-61\n11-62,11-12\n31-94,25-85\n2-13,1-7\n8-95,7-7\n62-70,91-94\n38-98,38-98\n33-94,33-78\n6-70,29-71\n14-95,2-61\n25-25,25-44\n44-70,36-52\n19-19,20-27\n20-75,5-76\n2-94,93-93\n37-40,38-40\n2-97,2-2\n57-78,56-84\n40-88,10-59\n91-96,30-91\n1-1,2-63\n21-83,20-20\n49-91,48-92\n45-58,5-51\n21-21,22-90\n95-97,7-96\n1-2,1-45\n31-70,32-70\n35-36,1-35\n12-95,12-86\n63-97,63-97\n11-34,10-27\n21-81,20-21\n80-83,74-79\n5-99,98-98\n27-38,26-87\n18-43,19-42\n3-91,2-7\n12-77,12-96\n67-76,51-75\n78-82,7-78\n47-95,46-95\n12-84,13-45\n35-65,35-75\n71-71,13-72\n2-99,98-98\n6-82,5-7\n49-50,50-52\n3-98,1-98\n61-61,22-61\n27-42,29-41\n5-21,20-80\n51-82,50-50\n2-11,4-10\n10-83,10-98\n33-33,2-33\n1-2,1-97\n17-96,3-95\n45-77,46-59\n18-58,17-18\n41-94,93-94\n2-97,95-99\n67-82,64-82\n1-94,1-94\n5-23,2-24\n16-20,6-20\n3-6,5-93\n21-35,20-45\n4-94,59-98\n53-86,40-54\n6-8,7-95\n1-97,1-1\n26-46,36-47\n82-82,52-82\n21-38,22-34\n88-94,20-94\n96-97,1-96\n36-48,35-48\n65-65,66-90\n2-97,1-2\n80-97,80-92\n74-87,68-81\n69-82,70-79\n87-96,4-95\n91-91,33-90\n17-73,73-74\n22-22,21-98\n44-63,45-64\n37-55,51-61\n51-56,56-56\n29-83,28-84\n69-70,69-97\n22-24,23-30\n7-7,8-90\n8-32,3-31\n79-79,79-91\n4-98,5-80\n1-99,2-70\n11-52,12-12\n35-88,36-88\n31-92,30-93\n8-34,33-82\n3-97,99-99\n5-86,54-70\n5-98,3-99\n4-93,1-4\n15-92,14-91\n9-94,13-94\n2-98,2-30\n9-95,29-95\n59-94,60-95\n36-95,81-98\n17-95,18-96\n3-26,25-84\n32-99,13-75\n9-44,8-97\n3-96,96-99\n21-21,20-59\n14-56,28-55\n19-35,35-84\n82-83,56-83\n89-89,78-89\n24-64,23-57\n71-71,39-72\n84-91,90-94\n18-98,19-98\n12-70,13-71\n75-95,94-95\n72-79,72-77\n11-90,10-94\n2-98,2-98\n4-86,3-87\n6-97,2-97\n68-97,45-97\n91-92,12-92\n32-59,32-98\n11-91,12-85\n28-84,74-85\n8-99,2-99\n2-69,3-9\n72-97,58-91\n4-33,3-33\n12-63,11-64\n56-56,57-70\n56-62,51-59\n17-70,18-62\n1-94,1-99\n1-78,1-1\n3-97,2-2")
(part1 input)
(part2 input)
